(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).resourcePreloader=n()}(this,function(){"use strict";let e={timeout:1500,retry:0};const n=new Map;function r(e,r,t){return new Promise(function(o,s){const i=function(e){if(!n.has(e))throw new Error(`未找到${e}类型的加载器，请先注册自定义加载器`);return n.get(e)}(r),a=setTimeout(()=>{s(new Error(`Resource ${e} load timeout (${t}ms)`))},t);i(e).then(function(n){clearTimeout(a),o({url:e,success:!0,data:n,error:null})}).catch(function(n){clearTimeout(a),s({url:e,success:!1,data:null,error:n})})})}async function t(e,n,o,s){if(s.has(e))return s.get(e);const i=n.find(n=>n.name===e);if(!i)throw new Error(`未找到name为${e}的资源配置`);const a=i.dependencies||[];for(const e of a)await t(e,n,o,s);const{urls:c,type:u}=i;let f=null,l="success",d=null;try{f=await async function(e,n,t,o){if(!Array.isArray(n)||0===n.length)throw new Error("urls必须是非空数组");const s=[];for(const i of n)try{const n=await r(i,t,o);return s.length&&console.warn(`加载${e}资源时的一些错误信息：`,s),n}catch(e){s.push({url:i,error:e})}throw console.warn(`所有${e}资源加载错误信息`,s),new Error(`所有${e}资源加载失败，错误内容看上面`)}(e,c,u,o)}catch(e){l="failed",d=e}const w={name:e,config:i,result:f,status:l,error:d};return s.set(e,w),w}async function o(n){if(!Array.isArray(n)||0===n.length)throw new Error("配置数组必须是非空数组");const r=n.map(function(e){if("string"==typeof e){const n=new URL(e,window.location.href);return{name:n.pathname,urls:[e],type:n.pathname.split(".").pop()||"js"}}if(Array.isArray(e)){if(!e.length)return;const n=new URL(e[0],window.location.href);return{name:n.pathname,urls:e,type:n.pathname.split(".").pop()||"js"}}return"string"==typeof e.urls&&(e.urls=[e.urls]),e}).filter(Boolean),{timeout:o}={...e};!function(e){const n=new Map(e.map(e=>[e.name,e])),r=new Set,t=new Set;for(const t of e)r.has(t.name)||o(n,t.name);function o(e,n){const s=e.get(n);if(!s)throw new Error(`未找到ID为${n}的资源配置`);if(t.has(n))throw new Error(`检测到循环依赖：${Array.from(t).join(" -> ")} -> ${n}`);if(r.has(n))return;t.add(n);const i=s.dependencies||[];for(const n of i)o(e,n);t.delete(n),r.add(n)}}(r);const s=new Map,i=r.map(async function(e){return await t(e.name,r,o,s)});return Promise.all(i).then(function(e){return e.find(e=>e.error)?Promise.reject(e):e})}return n.set("js",function(e){const n=document.createElement("script");return new Promise(function(r,t){n.type="text/javascript",n.src=e,n.async=!1,n.dataset.flag="resource-preloader",n.addEventListener("load",function(e){r(n)}),n.addEventListener("error",function(){t(new Error(`JS resource ${e} load failed`))}),document.head.appendChild(n)}).finally(function(){document.head.removeChild(n)})}),n.set("css",function(e){return new Promise(function(n,r){const t=document.createElement("link");t.rel="stylesheet",t.href=e,t.dataset.flag="resource-preloader",t.addEventListener("load",function(){n(t)}),t.addEventListener("error",function(){r(new Error(`CSS resource ${e} load failed`)),document.head.removeChild(t)}),document.head.appendChild(t)})}),n.set("img",function(e){const n=new Image;return n.dataset.flag="resource-preloader",new Promise(function(r,t){n.addEventListener("load",function(){r(n)}),n.addEventListener("error",function(){t(new Error(`IMG resource ${e} load failed`))}),n.src=e})}),n.set("json",function(e){return fetch(e).then(function(n){if(!n.ok)throw new Error(`JSON resource ${e} load failed`);return n.json()}).catch(function(n){throw new Error(`JSON resource ${e} load failed: ${n.message}`)})}),o.registerLoader=function(e,r){if("string"!=typeof e||""===e.trim())throw new Error("资源类型必须是非空字符串");const t=Object.prototype.toString.call(e).slice(8,-1);if(["Function","AsyncFunction"].includes(t))throw new Error("加载器必须是一个函数返回Promise对象或一个异步函数");n.has(e)&&console.warn(`类型为${e}的加载器已存在，将被覆盖`),n.set(e,r)},o.setGlobalConfig=function(n){if("object"!=typeof n||null===n)throw new Error("配置参数必须是一个非空对象");return e={...e,...n},{...e}},o});


},{}],2:[function(require,module,exports){
const loader = require('../dist/resource-preloader.umd.min.js');

each('CJS', loader);


},{"../dist/resource-preloader.umd.min.js":1}]},{},[2]);
